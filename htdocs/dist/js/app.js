(()=>{var t={295:()=>{document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("langSelect");t&&t.addEventListener("change",(()=>{const e=t.value;document.cookie=`bq_locale=${e};path=/;max-age=31536000;SameSite=Lax`,location.reload()}))}))}},e={};function a(s){var n=e[s];if(void 0!==n)return n.exports;var i=e[s]={exports:{}};return t[s](i,i.exports,a),i.exports}(()=>{"use strict";class t{static setup(e=".accordeon"){document.addEventListener("click",(a=>{const s=a.target.closest(`${e} .accordeon-title`);if(!s)return;const n=s.closest(e),i=n.querySelector(".accordeon-content");i&&t.toggle(n,i)}))}static toggle(t,e){if(t.classList.contains("active"))e.style.maxHeight=e.scrollHeight+"px",e.offsetHeight,e.style.maxHeight="0",t.classList.remove("active");else{e.style.maxHeight=e.scrollHeight+"px",t.classList.add("active");const a=()=>{t.classList.contains("active")&&(e.style.maxHeight="none"),e.removeEventListener("transitionend",a)};e.addEventListener("transitionend",a)}}}a(295);class e{static _domains={};static _loaded={};static async load(t){if(!this._loaded[t]){try{const e=await fetch(`/admin/api/locale/domain/get/${t}`);if(!e.ok)throw new Error(`Error for domain: ${t}`);const a=await e.json();return this._domains[t]=a,this._loaded[t]=!0,a}catch(t){console.error(`[Translator] ${t.message}`)}return null}}static async translate(t,e="bugquest",a={}){e=e.trim(),t=t.trim(),this._loaded[e]||await this.load(e);let s=this._domains[e]?.[t]??t;return this._applyReplacements(s,a)}static t(t,e="bugquest",a={}){let s=this._domains[e]?.[t]??t;return this._applyReplacements(s,a)}static _applyReplacements(t,e){return t.replace(/{(.*?)}/g,((t,a)=>e[a]??t))}}function s(t,a="bugquest",s={}){return e.t(t,a,s)}class n{static createEl=(t,e,a="")=>{const s=document.createElement(t);return s.className=e,a&&(s.innerText=a),s};static accordion(t,e){let a=document.createElement("div");a.className="__accordeon accordeon",e&&a.classList.add(e);let s=document.createElement("div");s.className="__accordeon_title accordeon-title",s.textContent=t,a.appendChild(s);let n=document.createElement("div");return n.className="accordeon-content",a.appendChild(n),{accordeon:a,accordeon_content:n}}static glow_stick(){let t=document.createElement("div");return t.className="glow-bar",t}static label(t="",e=""){let a=document.createElement("label");return e&&(a.className=e),t&&(a.textContent=t),a}static input_text(t="",e="",a=""){let s=document.createElement("input");return s.type="text",t&&(s.placeholder=t),e&&(s.value=e),a&&(s.className=a),s}static textarea(t="",e="",a=""){let s=document.createElement("textarea");return t&&(s.placeholder=t),e&&(s.value=e),a&&(s.className=a),s}static input_number(t="",e=1,a="",s=""){let n=document.createElement("input");return n.type="number",e&&(n.step=e),t&&(n.placeholder=t),a&&(n.value=a),s&&(n.className=s),n}static input_search(t="",e="",a=null,s=null,n=2){let i=this.input_text(t,"",e);return i.type="search",i.addEventListener("input",(()=>{let t=i.value;t.length>=n?a(t):s()})),i}static input_password(t="",e="",a=""){let s=this.input_text(t,e,a);return s.type="password",s}static checkbox(t="",e=!1,a="",s=null){let n=document.createElement("input");n.type="checkbox",e&&(n.checked=!0),a&&(n.className=a),s&&n.addEventListener("change",s);let i=this.label(t);return i.prepend(n),i}static switch(t=!1,e=null){let a=document.createElement("div");return a.className="switch",a.dataset.state=t?"on":"off",a.title=s(t?"Activé":"Désactivé","options"),a.addEventListener("click",(()=>{a.dataset.state="on"===a.dataset.state?"off":"on",a.title="on"===a.dataset.state?s("Activé","options"):s("Désactivé","options"),e&&e("on"===a.dataset.state)})),{element:a,value:()=>"on"===a.dataset.state,toggle:t=>{a.dataset.state=t?"on":"off",a.title=s(t?"Activé":"Désactivé","options")}}}static button_submit(t="Envoyer",e="button button-primary"){let a=document.createElement("button");return a.type="submit",e&&(a.className=e),t&&(a.textContent=t),a}static button(t="Button",e="button",a=null){let s=document.createElement("div");return e&&(s.className=e),t&&(s.textContent=t),a&&s.addEventListener("click",a),s}static div(t=""){let e=document.createElement("div");return t&&(e.className=t),e}static span(t=""){let e=document.createElement("span");return t&&(e.className=t),e}static modal(t="",e=null,a=null){const s=this.div("modal"),n=this.div("modal-wrapper"),i=this.div("modal-close"),c=this.div("modal-content");let l=null;t&&(l=this.div("modal-title"),l.textContent=t,n.appendChild(l)),n.appendChild(i),n.appendChild(c),s.appendChild(n);const o=()=>{s.classList.remove("active"),a&&a()};return i.addEventListener("click",o),s.addEventListener("click",(t=>{t.target===s&&o()})),{element:s,open:()=>{s.classList.add("active"),e&&e()},close:o,title:l??"",content:c}}static h2(t,e=""){let a=document.createElement("h2");return e&&(a.className=e),a.textContent=t,a}static h3(t,e=""){let a=document.createElement("h3");return e&&(a.className=e),a.textContent=t,a}static h4(t,e=""){let a=document.createElement("h4");return e&&(a.className=e),a.textContent=t,a}static img(t,e="",a=""){let s=document.createElement("img");return s.src=t,s.alt=e||Math.random().toString(16).slice(2),a&&(s.className=a),s}static list(t=[],e="",a="",s=null){let n=document.createElement("ul");return e&&(n.className=e),t.forEach((t=>{let e=document.createElement("li");e.innerHTML=t,a&&(e.className=a),s&&e.addEventListener("click",(()=>{s(t)})),n.appendChild(e)})),n}static search(t="Rechercher...",e=null,a=null,s=2,i=!1){let c=this.div("search-container"),l=this.input_text(t);l.type="search";let o=this.div("search-results "+(i?" open-bottom":"open-top"));return c.appendChild(l),c.appendChild(o),e&&l.addEventListener("input",(()=>{let t=l.value;t.length>=s?e(t):o.innerHTML=""})),a&&o.addEventListener("click",(t=>{let e=t.target.closest(".result-item");if(!e)return;let s=JSON.parse(e.dataset.item);s&&a(s)})),{close:()=>{o.innerHTML="",l.value="",o.classList.remove("active")},clean:()=>{o.innerHTML=""},populate:t=>{for(const[e,a]of Object.entries(t)){const t=n.div("result-item");t.textContent=e,t.dataset.item=JSON.stringify(a),o.appendChild(t)}o.classList.add("active")},addItem:(t,e)=>{const a=n.div("result-item");a.textContent=t,a.dataset.item=JSON.stringify(e),o.appendChild(a),o.classList.contains("active")||o.classList.add("active")},element:c}}static select(t,e,a=null,s=null,n=!1){let i=a;const c=this.createEl("div","select-wrapper"),l=this.createEl("div","select-head"),o=this.createEl("div","select-label",t),r=this.createEl("div","select-value",a||""),d=this.createEl("div","select-body"),u="object"==typeof e[0],p=t=>{t?(d.style.display="block",d.offsetHeight,d.classList.add("active"),d.style.top=n?"0":"auto",d.style.bottom=n?"auto":"0"):(d.classList.remove("active"),setTimeout((()=>{d.classList.contains("active")||(d.style.display="none")}),300))};return e.forEach((t=>{const e=u?t.value:t,s=u?t.label:t,n=this.createEl("div","select-item",s);n.dataset.value=e,e===a&&n.classList.add("active"),d.appendChild(n)})),s&&d.addEventListener("click",(t=>{if(t.target.classList.contains("select-item")){const e=t.target.dataset.value;i=e,r.innerText=t.target.innerText,[...d.children].forEach((t=>t.classList.remove("active"))),t.target.classList.add("active"),s(e),p(!1)}})),l.append(o,r),c.append(l,d),l.addEventListener("click",(()=>p(!0))),document.addEventListener("click",(t=>{c.contains(t.target)||p(!1)})),{element:c,toogle:p,getValue:()=>i,setValue:t=>{i=t;const e=[...d.children],a=e.find((e=>e.dataset.value===t));r.innerText=a?a.innerText:"",e.forEach((t=>t.classList.remove("active"))),a&&a.classList.add("active")}}}static selectMultiple(t,e,a=[],s=null,n=!1){let i=Array.isArray(a)?a:[];const c=this.createEl("div","select-wrapper"),l=this.createEl("div","select-head"),o=this.createEl("div","select-label",t),r=this.createEl("div","select-value",i.join(", ")),d=this.createEl("div","select-body"),u="object"==typeof e[0],p=()=>{const t=[...d.children].filter((t=>i.includes(t.dataset.value)));r.innerText=t.map((t=>t.innerText)).join(", ")||"Aucun"},h=t=>{t?(d.style.display="block",d.offsetHeight,d.classList.add("active"),d.style.top=n?"0":"auto",d.style.bottom=n?"auto":"0"):(d.classList.remove("active"),setTimeout((()=>{d.classList.contains("active")||(d.style.display="none")}),300))};return e.forEach((t=>{const e=u?t.value:t,a=u?t.label:t,s=this.createEl("div","select-item",a);s.dataset.value=e,i.includes(e)&&s.classList.add("active"),d.appendChild(s)})),s&&d.addEventListener("click",(t=>{if(t.target.classList.contains("select-item")){const e=t.target.dataset.value,a=i.indexOf(e);a>-1?(i.splice(a,1),t.target.classList.remove("active")):(i.push(e),t.target.classList.add("active")),p(),s([...i])}})),l.append(o,r),c.append(l,d),l.addEventListener("click",(()=>h(!0))),document.addEventListener("click",(t=>{c.contains(t.target)||h(!1)})),{element:c,toogle:h,getValue:()=>[...i],setValue:t=>{i=Array.isArray(t)?t:[];[...d.children].forEach((t=>{i.includes(t.dataset.value)?t.classList.add("active"):t.classList.remove("active")})),p()}}}static table(t=[],e=[],a="",s="",n=""){let i=document.createElement("table");a&&(i.className=a);let c=document.createElement("thead"),l=document.createElement("tbody");return t.length>0&&t.forEach((t=>{let e=document.createElement("th");e.textContent=t,s&&(e.className=s),c.appendChild(e)})),e.length>0&&e.forEach((t=>{let e=document.createElement("tr");t.forEach((t=>{let a=document.createElement("td");"object"==typeof t&&null!==t&&"value"in t&&"full"in t?(a.textContent=t.value,a.title=t.full,a.classList.add("truncated")):a.textContent=t,n&&(a.className=n),e.appendChild(a)})),l.appendChild(e)})),i.appendChild(c),i.appendChild(l),i}}class i{static containers=new Map;static show(t,{type:e="info",position:a="top-right",duration:s=4e3,icon:i=null,closable:c=!0}={}){const l=this._getContainer(a),o=n.div(`bq-toast ${e}`);if(i){const t=n.div("bq-toast-icon");t.innerHTML=i,o.appendChild(t)}const r=n.div("bq-toast-message");if(r.innerHTML=t,o.appendChild(r),c){const t=n.div("bq-toast-close");t.innerHTML="✖",t.title="Fermer",t.addEventListener("click",(()=>this._removeToast(o))),o.appendChild(t)}l.appendChild(o),requestAnimationFrame((()=>{o.classList.add("show")})),s>0&&setTimeout((()=>this._removeToast(o)),s)}static success(t){this.show(t,{type:"success",icon:"✅"})}static info(t){this.show(t,{type:"info",icon:"ℹ️"})}static warning(t){this.show(t,{type:"warning",icon:"⚠️"})}static error(t){this.show(t,{type:"danger",icon:"❌"})}static _getContainer(t){if(!this.containers.has(t)){const e=n.div(`bq-toast-container ${t}`);document.body.appendChild(e),this.containers.set(t,e)}return this.containers.get(t)}static _removeToast(t){t.classList.remove("show"),setTimeout((()=>t.remove()),300)}}class c{static panel=null;static isDragging=!1;static offset={x:0,y:0};static async init(){this.panel=n.div("debug-panel");const t=n.h3("Debug Panel"),e=n.div("close-btn");if(e.textContent="x",this.panel.append(t,e),document.body.appendChild(this.panel),!this.panel)return;this.restoreFromStorage(),document.addEventListener("keypress",(t=>{178!==t.which&&64!==t.which||(this.panel.classList.toggle("active"),localStorage.setItem("debugPanelActive",this.panel.classList.contains("active")))}));const a=this.panel.querySelector(".close-btn");a&&a.addEventListener("click",(()=>{this.panel.classList.remove("active"),localStorage.setItem("debugPanelActive",!1)})),this.panel.addEventListener("mousedown",this.startDrag.bind(this)),document.addEventListener("mousemove",this.onDrag.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),await this.loadMetrics(),this.kvSection=n.div("kv-section"),this.kvWrap=n.div("wrap"),this.panel.appendChild(this.kvSection),this.kvValues={},window.debugPanel=this}static startDrag(t){this.panel.classList.contains("active")&&(this.isDragging=!0,this.offset.x=t.clientX-this.panel.offsetLeft,this.offset.y=t.clientY-this.panel.offsetTop,this.panel.classList.add("dragging"),this.panel.style.transition="none")}static onDrag(t){if(!this.isDragging)return;const e=t.clientX-this.offset.x,a=t.clientY-this.offset.y;this.panel.style.left=`${e}px`,this.panel.style.top=`${a}px`,this.panel.style.bottom="auto",this.panel.style.right="auto",localStorage.setItem("debugPanelPosition",JSON.stringify({x:e,y:a}))}static stopDrag(){this.isDragging&&(this.isDragging=!1,this.panel.classList.remove("dragging"),this.panel.style.transition="")}static restoreFromStorage(){const t=localStorage.getItem("debugPanelActive");this.panel.classList.toggle("active","true"===t);const e=localStorage.getItem("debugPanelPosition");if(e)try{const{x:t,y:a}=JSON.parse(e);this.panel.style.left=`${t}px`,this.panel.style.top=`${a}px`,this.panel.style.bottom="auto",this.panel.style.right="auto"}catch(t){const e=window.innerWidth,a=window.innerHeight,s=(e-this.panel.offsetWidth)/2,n=(a-this.panel.offsetHeight)/2;this.panel.style.left=`${s}px`,this.panel.style.top=`${n}px`,this.panel.style.bottom="auto",this.panel.style.right="auto"}}static addGroup(t,e){const{accordeon:a,accordeon_content:s}=n.accordion(t),i=n.div("wrap");if(s.appendChild(i),this.panel.appendChild(a),Array.isArray(e)){if("queries"===t){const t=["SQL","Bindings","Durée"],a=e.map((t=>{const e=parseFloat(t.time),a=e>=1e3?`${(e/1e3).toFixed(3)} s`:`${e.toFixed(2)} ms`;return[{value:t.query,full:t.query},t.bindings.map((t=>`"${t}"`)).join(", "),a]})),s=e.reduce(((t,e)=>t+parseFloat(e.time)),0),c=s>=1e3?`${(s/1e3).toFixed(3)} s`:`${s.toFixed(2)} ms`,l=n.table(t,a,"debug-table"),o=document.createElement("tfoot"),r=document.createElement("tr"),d=document.createElement("td");d.textContent="Total",d.colSpan=2;const u=document.createElement("td");return u.textContent=c,r.append(d,u),o.appendChild(r),l.appendChild(o),void i.appendChild(l)}e.forEach(((t,e)=>{const a=n.div("debug-line");a.textContent=`${e}: ${JSON.stringify(t)}`,i.appendChild(a)}))}else for(const t in e){const a=e[t],s=n.div("debug-line");s.innerHTML=`${t}: ${a}`,i.appendChild(s)}}static renderQueries(){}static async loadMetrics(){await fetch("/admin/api/debug/metrics").then((t=>t.json())).then((t=>{if(t){if("success"in t&&!t.success)return i.show(s("Erreur lors du chargement des metrics:","admin")+" "+t?.message,{type:"danger",icon:"❌"}),void console.error(s("Erreur lors du chargement des metrics:","admin")+" "+t?.message);for(const e in t)this.addGroup(e,t[e])}}))}static updateValue(t,e){if(this.kvValues)if(this.kvValues[t])this.kvValues[t].textContent=e;else{const a=n.div("debug-line");a.innerHTML=`<strong>${t}</strong>: <span class="debug-value">${e}</span>`,this.kvWrap.appendChild(a),this.kvValues[t]=a.querySelector(".debug-value")}}}document.addEventListener("DOMContentLoaded",(async()=>{await c.init(),t.setup(),await new Promise((t=>setTimeout(t,100))),document.dispatchEvent(new CustomEvent("bqAppLoaded")),console.log("%c[App] JS chargé avec succès 🛠️","color: cyan; font-weight: bold")}))})()})();
//# sourceMappingURL=app.js.map