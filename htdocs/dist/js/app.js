(()=>{var t={295:()=>{document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("langSelect");t&&t.addEventListener("change",(()=>{const e=t.value;document.cookie=`bq_locale=${e};path=/;max-age=31536000;SameSite=Lax`,location.reload()}))}))}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,n),i.exports}(()=>{"use strict";class t{static setup(e=".accordeon"){document.addEventListener("click",(n=>{const a=n.target.closest(`${e} .accordeon-title`);if(!a)return;const s=a.closest(e),i=s.querySelector(".accordeon-content");i&&t.toggle(s,i)}))}static toggle(t,e){if(t.classList.contains("active"))e.style.maxHeight=e.scrollHeight+"px",e.offsetHeight,e.style.maxHeight="0",t.classList.remove("active");else{e.style.maxHeight=e.scrollHeight+"px",t.classList.add("active");const n=()=>{t.classList.contains("active")&&(e.style.maxHeight="none"),e.removeEventListener("transitionend",n)};e.addEventListener("transitionend",n)}}}n(295);class e{static _domains={};static _loaded={};static async load(t){if(!this._loaded[t]){try{const e=await fetch(`/admin/api/locale/domain/get/${t}`);if(!e.ok)throw new Error(`Error for domain: ${t}`);const n=await e.json();return this._domains[t]=n,this._loaded[t]=!0,n}catch(t){console.error(`[Translator] ${t.message}`)}return null}}static async translate(t,e="bugquest",n={}){e=e.trim(),t=t.trim(),this._loaded[e]||await this.load(e);let a=this._domains[e]?.[t]??t;return this._applyReplacements(a,n)}static t(t,e="bugquest",n={}){let a=this._domains[e]?.[t]??t;return this._applyReplacements(a,n)}static _applyReplacements(t,e){return t.replace(/{(.*?)}/g,((t,n)=>e[n]??t))}}function a(t,n="bugquest",a={}){return e.t(t,n,a)}class s{static accordion(t,e){let n=document.createElement("div");n.className="__accordeon accordeon",e&&n.classList.add(e);let a=document.createElement("div");a.className="__accordeon_title accordeon-title",a.textContent=t,n.appendChild(a);let s=document.createElement("div");return s.className="accordeon-content",n.appendChild(s),{accordeon:n,accordeon_content:s}}static glow_stick(){let t=document.createElement("div");return t.className="glow-bar",t}static label(t="",e=""){let n=document.createElement("label");return e&&(n.className=e),t&&(n.textContent=t),n}static input_text(t="",e="",n=""){let a=document.createElement("input");return a.type="text",t&&(a.placeholder=t),e&&(a.value=e),n&&(a.className=n),a}static textarea(t="",e="",n=""){let a=document.createElement("textarea");return t&&(a.placeholder=t),e&&(a.value=e),n&&(a.className=n),a}static input_number(t="",e=1,n="",a=""){let s=document.createElement("input");return s.type="number",e&&(s.step=e),t&&(s.placeholder=t),n&&(s.value=n),a&&(s.className=a),s}static input_search(t="",e="",n=null,a=null,s=2){let i=this.input_text(t,"",e);return i.type="search",i.addEventListener("input",(()=>{let t=i.value;t.length>=s?n(t):a()})),i}static input_password(t="",e="",n=""){let a=this.input_text(t,e,n);return a.type="password",a}static checkbox(t="",e=!1,n="",a=null){let s=document.createElement("input");s.type="checkbox",e&&(s.checked=!0),n&&(s.className=n),a&&s.addEventListener("change",a);let i=this.label(t);return i.prepend(s),i}static switch(t=!1,e=null){let n=document.createElement("div");return n.className="switch",n.dataset.state=t?"on":"off",n.title=a(t?"Activé":"Désactivé","options"),n.addEventListener("click",(()=>{n.dataset.state="on"===n.dataset.state?"off":"on",n.title="on"===n.dataset.state?a("Activé","options"):a("Désactivé","options"),e&&e("on"===n.dataset.state)})),{element:n,value:()=>"on"===n.dataset.state,toggle:t=>{n.dataset.state=t?"on":"off",n.title=a(t?"Activé":"Désactivé","options")}}}static button_submit(t="Envoyer",e="button button-primary"){let n=document.createElement("button");return n.type="submit",e&&(n.className=e),t&&(n.textContent=t),n}static button(t="Button",e="button",n=null){let a=document.createElement("div");return e&&(a.className=e),t&&(a.textContent=t),n&&a.addEventListener("click",n),a}static div(t=""){let e=document.createElement("div");return t&&(e.className=t),e}static span(t=""){let e=document.createElement("span");return t&&(e.className=t),e}static modal(t="",e=null,n=null){const a=this.div("modal"),s=this.div("modal-wrapper"),i=this.div("modal-close"),l=this.div("modal-content");let c=null;t&&(c=this.div("modal-title"),c.textContent=t,s.appendChild(c)),s.appendChild(i),s.appendChild(l),a.appendChild(s);const o=()=>{a.classList.remove("active"),n&&n()};return i.addEventListener("click",o),a.addEventListener("click",(t=>{t.target===a&&o()})),{element:a,open:()=>{a.classList.add("active"),e&&e()},close:o,title:c??"",content:l}}static h2(t,e=""){let n=document.createElement("h2");return e&&(n.className=e),n.textContent=t,n}static h3(t,e=""){let n=document.createElement("h3");return e&&(n.className=e),n.textContent=t,n}static h4(t,e=""){let n=document.createElement("h4");return e&&(n.className=e),n.textContent=t,n}static img(t,e="",n=""){let a=document.createElement("img");return a.src=t,a.alt=e||Math.random().toString(16).slice(2),n&&(a.className=n),a}static list(t=[],e="",n="",a=null){let s=document.createElement("ul");return e&&(s.className=e),t.forEach((t=>{let e=document.createElement("li");e.innerHTML=t,n&&(e.className=n),a&&e.addEventListener("click",(()=>{a(t)})),s.appendChild(e)})),s}static search(t="Rechercher...",e=null,n=null,a=2,i=!1){let l=this.div("search-container"),c=this.input_text(t);c.type="search";let o=this.div("search-results "+(i?" open-bottom":"open-top"));return l.appendChild(c),l.appendChild(o),e&&c.addEventListener("input",(()=>{let t=c.value;t.length>=a?e(t):o.innerHTML=""})),n&&o.addEventListener("click",(t=>{let e=t.target.closest(".result-item");if(!e)return;let a=JSON.parse(e.dataset.item);a&&n(a)})),{close:()=>{o.innerHTML="",c.value="",o.classList.remove("active")},clean:()=>{o.innerHTML=""},populate:t=>{for(const[e,n]of Object.entries(t)){const t=s.div("result-item");t.textContent=e,t.dataset.item=JSON.stringify(n),o.appendChild(t)}o.classList.add("active")},addItem:(t,e)=>{const n=s.div("result-item");n.textContent=t,n.dataset.item=JSON.stringify(e),o.appendChild(n),o.classList.contains("active")||o.classList.add("active")},element:l}}static select(t=[],e=null,n="",a=null){let s=document.createElement("select");return n&&(s.className=n),Array.isArray(t)&&t.length>0&&"object"==typeof t[0]?t.forEach((t=>{let n=document.createElement("option");n.value=t.value,n.textContent=t.label,e&&e===t.value&&(n.selected=!0),s.appendChild(n)})):Array.isArray(t)&&t.length>0&&t.forEach((t=>{let n=document.createElement("option");n.value=t,n.textContent=t,e&&e===t&&(n.selected=!0),s.appendChild(n)})),a&&s.addEventListener("change",(()=>{a(s.value)})),s}static table(t=[],e=[],n="",a="",s=""){let i=document.createElement("table");n&&(i.className=n);let l=document.createElement("thead"),c=document.createElement("tbody");return t.length>0&&t.forEach((t=>{let e=document.createElement("th");e.textContent=t,a&&(e.className=a),l.appendChild(e)})),e.length>0&&e.forEach((t=>{let e=document.createElement("tr");t.forEach((t=>{let n=document.createElement("td");"object"==typeof t&&null!==t&&"value"in t&&"full"in t?(n.textContent=t.value,n.title=t.full,n.classList.add("truncated")):n.textContent=t,s&&(n.className=s),e.appendChild(n)})),c.appendChild(e)})),i.appendChild(l),i.appendChild(c),i}}class i{static containers=new Map;static show(t,{type:e="info",position:n="top-right",duration:a=4e3,icon:i=null,closable:l=!0}={}){const c=this._getContainer(n),o=s.div(`bq-toast ${e}`);if(i){const t=s.div("bq-toast-icon");t.innerHTML=i,o.appendChild(t)}const r=s.div("bq-toast-message");if(r.innerHTML=t,o.appendChild(r),l){const t=s.div("bq-toast-close");t.innerHTML="✖",t.title="Fermer",t.addEventListener("click",(()=>this._removeToast(o))),o.appendChild(t)}c.appendChild(o),requestAnimationFrame((()=>{o.classList.add("show")})),a>0&&setTimeout((()=>this._removeToast(o)),a)}static _getContainer(t){if(!this.containers.has(t)){const e=s.div(`bq-toast-container ${t}`);document.body.appendChild(e),this.containers.set(t,e)}return this.containers.get(t)}static _removeToast(t){t.classList.remove("show"),setTimeout((()=>t.remove()),300)}}class l{static panel=null;static isDragging=!1;static offset={x:0,y:0};static async init(){this.panel=s.div("debug-panel");const t=s.h3("Debug Panel"),e=s.div("close-btn");if(e.textContent="x",this.panel.append(t,e),document.body.appendChild(this.panel),!this.panel)return;this.restoreFromStorage(),document.addEventListener("keypress",(t=>{178!==t.which&&64!==t.which||(this.panel.classList.toggle("active"),localStorage.setItem("debugPanelActive",this.panel.classList.contains("active")))}));const n=this.panel.querySelector(".close-btn");n&&n.addEventListener("click",(()=>{this.panel.classList.remove("active"),localStorage.setItem("debugPanelActive",!1)})),this.panel.addEventListener("mousedown",this.startDrag.bind(this)),document.addEventListener("mousemove",this.onDrag.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),await this.loadMetrics(),this.kvSection=s.div("kv-section"),this.kvWrap=s.div("wrap"),this.panel.appendChild(this.kvSection),this.kvValues={},window.debugPanel=this}static startDrag(t){this.panel.classList.contains("active")&&(this.isDragging=!0,this.offset.x=t.clientX-this.panel.offsetLeft,this.offset.y=t.clientY-this.panel.offsetTop,this.panel.classList.add("dragging"),this.panel.style.transition="none")}static onDrag(t){if(!this.isDragging)return;const e=t.clientX-this.offset.x,n=t.clientY-this.offset.y;this.panel.style.left=`${e}px`,this.panel.style.top=`${n}px`,this.panel.style.bottom="auto",this.panel.style.right="auto",localStorage.setItem("debugPanelPosition",JSON.stringify({x:e,y:n}))}static stopDrag(){this.isDragging&&(this.isDragging=!1,this.panel.classList.remove("dragging"),this.panel.style.transition="")}static restoreFromStorage(){const t=localStorage.getItem("debugPanelActive");this.panel.classList.toggle("active","true"===t);const e=localStorage.getItem("debugPanelPosition");if(e)try{const{x:t,y:n}=JSON.parse(e);this.panel.style.left=`${t}px`,this.panel.style.top=`${n}px`,this.panel.style.bottom="auto",this.panel.style.right="auto"}catch(t){const e=window.innerWidth,n=window.innerHeight,a=(e-this.panel.offsetWidth)/2,s=(n-this.panel.offsetHeight)/2;this.panel.style.left=`${a}px`,this.panel.style.top=`${s}px`,this.panel.style.bottom="auto",this.panel.style.right="auto"}}static addGroup(t,e){const{accordeon:n,accordeon_content:a}=s.accordion(t),i=s.div("wrap");if(a.appendChild(i),this.panel.appendChild(n),Array.isArray(e)){if("queries"===t){const t=["SQL","Bindings","Durée"],n=e.map((t=>{const e=parseFloat(t.time),n=e>=1e3?`${(e/1e3).toFixed(3)} s`:`${e.toFixed(2)} ms`;return[{value:t.query,full:t.query},t.bindings.map((t=>`"${t}"`)).join(", "),n]})),a=e.reduce(((t,e)=>t+parseFloat(e.time)),0),l=a>=1e3?`${(a/1e3).toFixed(3)} s`:`${a.toFixed(2)} ms`,c=s.table(t,n,"debug-table"),o=document.createElement("tfoot"),r=document.createElement("tr"),d=document.createElement("td");d.textContent="Total",d.colSpan=2;const u=document.createElement("td");return u.textContent=l,r.append(d,u),o.appendChild(r),c.appendChild(o),void i.appendChild(c)}e.forEach(((t,e)=>{const n=s.div("debug-line");n.textContent=`${e}: ${JSON.stringify(t)}`,i.appendChild(n)}))}else for(const t in e){const n=e[t],a=s.div("debug-line");a.innerHTML=`${t}: ${n}`,i.appendChild(a)}}static renderQueries(){}static async loadMetrics(){await fetch("/admin/api/debug/metrics").then((t=>t.json())).then((t=>{if(t){if("success"in t&&!t.success)return i.show(a("Erreur lors du chargement des metrics:","admin")+" "+t?.message,{type:"danger",icon:"❌"}),void console.error(a("Erreur lors du chargement des metrics:","admin")+" "+t?.message);for(const e in t)this.addGroup(e,t[e])}}))}static updateValue(t,e){if(this.kvValues)if(this.kvValues[t])this.kvValues[t].textContent=e;else{const n=s.div("debug-line");n.innerHTML=`<strong>${t}</strong>: <span class="debug-value">${e}</span>`,this.kvWrap.appendChild(n),this.kvValues[t]=n.querySelector(".debug-value")}}}document.addEventListener("DOMContentLoaded",(async()=>{await l.init(),t.setup(),await new Promise((t=>setTimeout(t,100))),document.dispatchEvent(new CustomEvent("bqAppLoaded")),console.log("%c[App] JS chargé avec succès 🛠️","color: cyan; font-weight: bold")}))})()})();
//# sourceMappingURL=app.js.map